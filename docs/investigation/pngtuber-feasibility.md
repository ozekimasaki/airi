# PNGtuber å®Ÿè£…å¯èƒ½æ€§èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ

## æ¦‚è¦

æœ¬ãƒ¬ãƒãƒ¼ãƒˆã¯ã€Project AIRIã«ãŠã„ã¦Live2Dã®ä»£ã‚ã‚Šã«PNGtuberã¨ã—ã¦ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’å‹•ã‹ã›ã‚‹ã‹ã‚’èª¿æŸ»ã—ãŸçµæœã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

## ç¾åœ¨ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åˆ†æ

### ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã‚·ã‚¹ãƒ†ãƒ 

ç¾åœ¨ã€`packages/stage-ui/src/stores/settings.ts` ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ `stageModelRenderer` ã¯ä»¥ä¸‹ã®3ç¨®é¡ã‚’ã‚µãƒãƒ¼ãƒˆ:

```typescript
stageModelRenderer: 'live2d' | 'vrm' | 'disabled'
```

ã‚¹ãƒ†ãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (`packages/stage-ui/src/components/scenes/Stage.vue`) ã§ã¯ã€ã“ã®ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼è¨­å®šã«åŸºã¥ã„ã¦ç•°ãªã‚‹ã‚·ãƒ¼ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¡¨ç¤º:

- `Live2DScene`: Live2Dãƒ¢ãƒ‡ãƒ«ç”¨
- `ThreeScene`: VRM (3Dãƒ¢ãƒ‡ãƒ«) ç”¨

### Live2Då®Ÿè£…ã®ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² |
|---------|------|
| `packages/stage-ui/src/components/scenes/Live2D.vue` | Live2Dã‚·ãƒ¼ãƒ³ã®ãƒ©ãƒƒãƒ‘ãƒ¼ |
| `packages/stage-ui/src/components/scenes/live2d/Model.vue` | Live2Dãƒ¢ãƒ‡ãƒ«ã®ãƒ­ãƒ¼ãƒ‰ãƒ»åˆ¶å¾¡ (~635è¡Œ) |
| `packages/stage-ui/src/components/scenes/live2d/Canvas.vue` | PixiJSã‚­ãƒ£ãƒ³ãƒã‚¹ç®¡ç† |
| `packages/stage-ui/src/composables/live2d/motion-manager.ts` | ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯ãƒ»ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ  |
| `packages/stage-ui/src/stores/live2d.ts` | Live2DçŠ¶æ…‹ç®¡ç† (ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ç­‰) |
| `packages/model-driver-lipsync/src/live2d/index.ts` | ãƒªãƒƒãƒ—ã‚·ãƒ³ã‚¯å‡¦ç† |

### Live2Dãƒ¢ãƒ‡ãƒ«ã§åˆ¶å¾¡ã•ã‚Œã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

```typescript
// packages/stage-ui/src/stores/live2d.ts ã‚ˆã‚Š
const defaultModelParameters = {
  angleX: 0,         // é¡”ã®è§’åº¦X
  angleY: 0,         // é¡”ã®è§’åº¦Y  
  angleZ: 0,         // é¡”ã®è§’åº¦Z
  leftEyeOpen: 1,    // å·¦ç›®ã®é–‹ã
  rightEyeOpen: 1,   // å³ç›®ã®é–‹ã
  leftEyeSmile: 0,   // å·¦ç›®ã®ç¬‘é¡”
  rightEyeSmile: 0,  // å³ç›®ã®ç¬‘é¡”
  mouthOpen: 0,      // å£ã®é–‹ã
  mouthForm: 0,      // å£ã®å½¢
  cheek: 0,          // é ¬
  bodyAngleX: 0,     // ä½“ã®è§’åº¦X
  bodyAngleY: 0,     // ä½“ã®è§’åº¦Y
  bodyAngleZ: 0,     // ä½“ã®è§’åº¦Z
  breath: 0,         // å‘¼å¸
  // ... ãã®ä»–çœ‰æ¯›é–¢é€£
}
```

### æ—¢å­˜ã®å…¥åŠ›ã‚½ãƒ¼ã‚¹

1. **ãƒªãƒƒãƒ—ã‚·ãƒ³ã‚¯**: `wlipsync` ã‚’ä½¿ç”¨ã—ãŸéŸ³å£°è§£æ â†’ `mouthOpenSize` ã‚’æ›´æ–°
2. **æ„Ÿæƒ…/ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³**: LLMå‡ºåŠ›ã‹ã‚‰ã®ã‚¨ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³æ¤œå‡º â†’ `currentMotion` ã‚’æ›´æ–°
3. **ãƒ“ãƒ¼ãƒˆã‚·ãƒ³ã‚¯**: éŸ³æ¥½ã®ãƒ“ãƒ¼ãƒˆã«åˆã‚ã›ãŸå‹•ã
4. **ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è¿½å¾“**: ãƒã‚¦ã‚¹/è¦–ç·šè¿½å¾“

---

## PNGtuberå®Ÿè£…ã®å¯èƒ½æ€§

### âœ… **çµè«–: å®Ÿè£…å¯èƒ½**

æ—¢å­˜ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ååˆ†ã«ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼ã§ã‚ã‚Šã€PNGtuberãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã¯æŠ€è¡“çš„ã«å®Ÿç¾å¯èƒ½ã§ã™ã€‚

### å®Ÿè£…ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

#### æ–¹æ³•1: æ–°ã—ã„ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—ã‚’è¿½åŠ  (æ¨å¥¨)

```typescript
// settings.ts ã‚’æ‹¡å¼µ
stageModelRenderer: 'live2d' | 'vrm' | 'pngtuber' | 'disabled'
```

**å¿…è¦ãªå®Ÿè£…:**

1. **`packages/stage-ui/src/components/scenes/PNGtuber.vue`** - æ–°è¦ä½œæˆ
   - PNGç”»åƒã®ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã‚·ãƒ¼ãƒˆ or å€‹åˆ¥ç”»åƒã‚’ç®¡ç†
   - çŠ¶æ…‹ (é€šå¸¸ã€å£é–‹ãã€ã¾ã°ãŸãã€æ„Ÿæƒ…) ã«å¿œã˜ãŸç”»åƒåˆ‡ã‚Šæ›¿ãˆ
   
2. **PNGtuberãƒ¢ãƒ‡ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å®šç¾©**
   ```typescript
   // display-models.ts ã«è¿½åŠ 
   export enum DisplayModelFormat {
     Live2dZip = 'live2d-zip',
     VRM = 'vrm',
     PNGtuber = 'pngtuber',  // æ–°è¦è¿½åŠ 
   }
   ```

3. **PNGtuberã‚¢ã‚»ãƒƒãƒˆæ§‹é€ ã®å®šç¾©**
   ```
   pngtuber-model/
   â”œâ”€â”€ manifest.json       # çŠ¶æ…‹å®šç¾©
   â”œâ”€â”€ idle.png           # é€šå¸¸çŠ¶æ…‹
   â”œâ”€â”€ idle-blink.png     # ã¾ã°ãŸã
   â”œâ”€â”€ talk-a.png         # å£: A
   â”œâ”€â”€ talk-e.png         # å£: E
   â”œâ”€â”€ talk-i.png         # å£: I
   â”œâ”€â”€ talk-o.png         # å£: O
   â”œâ”€â”€ talk-u.png         # å£: U
   â”œâ”€â”€ emotion-happy.png  # æ„Ÿæƒ…: å–œã³
   â”œâ”€â”€ emotion-sad.png    # æ„Ÿæƒ…: æ‚²ã—ã¿
   â””â”€â”€ ...
   ```

#### æ–¹æ³•2: ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã‚·ãƒ¼ãƒˆãƒ™ãƒ¼ã‚¹

å˜ä¸€ã®ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã‚·ãƒ¼ãƒˆã‹ã‚‰å„ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’åˆ‡ã‚Šå‡ºã™æ–¹å¼ã€‚
PixiJSã‚’æ—¢ã«ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã‚·ãƒ¼ãƒˆã®ã‚µãƒãƒ¼ãƒˆã¯å®¹æ˜“ã€‚

### å†åˆ©ç”¨å¯èƒ½ãªæ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å†åˆ©ç”¨æ–¹æ³• |
|---------------|-----------|
| `usePipelineCharacterSpeechPlaybackQueueStore` | TTSå†ç”Ÿã‚­ãƒ¥ãƒ¼ â†’ ãƒªãƒƒãƒ—ã‚·ãƒ³ã‚¯ãƒˆãƒªã‚¬ãƒ¼ |
| `model-driver-lipsync` | æ¯éŸ³æ¤œå‡º (A/E/I/O/U) â†’ PNGåˆ‡ã‚Šæ›¿ãˆ |
| `useEmotionsMessageQueue` | æ„Ÿæƒ…æ¤œå‡º â†’ PNGçŠ¶æ…‹åˆ‡ã‚Šæ›¿ãˆ |
| `useLive2d` store (éƒ¨åˆ†çš„) | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç®¡ç†ã®ãƒ™ãƒ¼ã‚¹ |
| Canvas/Screen ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | æç”»é ˜åŸŸç®¡ç† |

### å®Ÿè£…ã®é›£æ˜“åº¦

| é …ç›® | é›£æ˜“åº¦ | ç†ç”± |
|------|--------|------|
| åŸºæœ¬è¡¨ç¤º | ğŸŸ¢ ä½ | PNGç”»åƒã®è¡¨ç¤ºã¯å˜ç´” |
| ãƒªãƒƒãƒ—ã‚·ãƒ³ã‚¯ | ğŸŸ¢ ä½ | æ—¢å­˜ã® `getMouthOpen()` / `getVowelWeights()` ã‚’æ´»ç”¨ |
| ã¾ã°ãŸã | ğŸŸ¢ ä½ | æ—¢å­˜ã® `useMotionUpdatePluginAutoEyeBlink` ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’æµç”¨ |
| æ„Ÿæƒ…åˆ‡ã‚Šæ›¿ãˆ | ğŸŸ¢ ä½ | æ—¢å­˜ã®æ„Ÿæƒ…ã‚­ãƒ¥ãƒ¼ã‚’æ´»ç”¨ |
| ãƒ“ãƒ¼ãƒˆã‚·ãƒ³ã‚¯ | ğŸŸ¡ ä¸­ | ç”»åƒã®è»½å¾®ãªå¤‰å½¢/ãƒã‚¦ãƒ³ã‚¹ã§å¯¾å¿œå¯èƒ½ |
| ã‚¹ãƒ ãƒ¼ã‚ºãªé·ç§» | ğŸŸ¡ ä¸­ | ã‚¯ãƒ­ã‚¹ãƒ•ã‚§ãƒ¼ãƒ‰ã‚„ãƒˆã‚¥ã‚¤ãƒ¼ãƒ³ã®å®Ÿè£…ãŒå¿…è¦ |
| ãƒ¢ãƒ‡ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ | ğŸŸ¡ ä¸­ | ZIP/ãƒ•ã‚©ãƒ«ãƒ€èª­ã¿è¾¼ã¿UIã®æ‹¡å¼µ |

---

## æ¨å¥¨å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

### Phase 1: åŸºæœ¬å®Ÿè£…

1. `DisplayModelFormat.PNGtuber` ã‚’è¿½åŠ 
2. `PNGtuber.vue` ã‚·ãƒ¼ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆ
3. ã‚·ãƒ³ãƒ—ãƒ«ãª2çŠ¶æ…‹ (å£é–‹ã/é–‰ã˜) ã®åˆ‡ã‚Šæ›¿ãˆã‚’å®Ÿè£…
4. æ—¢å­˜ã® `mouthOpenSize` ã«æ¥ç¶š

### Phase 2: æ‹¡å¼µæ©Ÿèƒ½

1. æ¯éŸ³ã”ã¨ã®å£ã®å½¢ (A/E/I/O/U)
2. è‡ªå‹•ã¾ã°ãŸã
3. æ„Ÿæƒ…ã«å¿œã˜ãŸè¡¨æƒ…åˆ‡ã‚Šæ›¿ãˆ
4. ã‚¹ãƒ ãƒ¼ã‚ºãªãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ (ãƒ•ã‚§ãƒ¼ãƒ‰)

### Phase 3: ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£

1. PNGtuberãƒ¢ãƒ‡ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆUI
2. è¨­å®šç”»é¢ã§ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
3. ã‚«ã‚¹ã‚¿ãƒ ãƒˆãƒªã‚¬ãƒ¼è¨­å®š

---

## æŠ€è¡“çš„è€ƒæ…®äº‹é …

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- PNGtuberã¯Live2Dã‚ˆã‚Šè»½é‡ (GPUè² è·ãŒä½ã„)
- ç”»åƒãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã§ã‚¹ãƒ ãƒ¼ã‚ºãªåˆ‡ã‚Šæ›¿ãˆã‚’å®Ÿç¾
- PixiJS or å˜ç´”ãªCanvas APIã§æç”»å¯èƒ½

### äº’æ›æ€§

- æ—¢å­˜ã®TTS/ãƒªãƒƒãƒ—ã‚·ãƒ³ã‚¯ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ã®çµ±åˆã¯å®¹æ˜“
- æ„Ÿæƒ…æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ ã¯ãã®ã¾ã¾åˆ©ç”¨å¯èƒ½
- è¨­å®šUIã®æ‹¡å¼µã§å¯¾å¿œå¯èƒ½

### åˆ¶é™äº‹é …

- Live2Dã®æ»‘ã‚‰ã‹ãªå¤‰å½¢ã¯å†ç¾ä¸å¯ (æ®µéšçš„ãªç”»åƒåˆ‡ã‚Šæ›¿ãˆã®ã¿)
- è¦–ç·šè¿½å¾“ã¯ç”»åƒã‚»ãƒƒãƒˆãŒå¿…è¦
- è¡¨ç¾ã®è‡ªç”±åº¦ã¯ã‚¢ã‚»ãƒƒãƒˆæ•°ã«ä¾å­˜

---

## çµè«–

**PNGtuberã¨ã—ã¦ã®å®Ÿè£…ã¯ååˆ†ã«å¯èƒ½** ã§ã™ã€‚

æ—¢å­˜ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯:
1. ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã®æŠ½è±¡åŒ–ãŒé©åˆ‡ã«è¡Œã‚ã‚Œã¦ã„ã‚‹
2. ãƒªãƒƒãƒ—ã‚·ãƒ³ã‚¯ãƒ»æ„Ÿæƒ…æ¤œå‡ºã¯ç‹¬ç«‹ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
3. PixiJSãŒæ—¢ã«å°å…¥ã•ã‚Œã¦ãŠã‚Šã‚¹ãƒ—ãƒ©ã‚¤ãƒˆæç”»ãŒå®¹æ˜“

**æ¨å¥¨**: `stageModelRenderer` ã« `'pngtuber'` ã‚’è¿½åŠ ã—ã€æ–°ã—ã„ã‚·ãƒ¼ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®Ÿè£…ã™ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒæœ€ã‚‚ã‚¯ãƒªãƒ¼ãƒ³ã§ã™ã€‚

---

## æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

- [x] PNGtuberã‚¢ã‚»ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ä»•æ§˜ç­–å®š
- [x] `PNGtuber.vue` ã‚·ãƒ¼ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…
- [x] `DisplayModelFormat.PNGtuber` ã®è¿½åŠ 
- [x] ã‚¤ãƒ³ãƒãƒ¼ãƒˆUIã®æ‹¡å¼µ
- [x] ãƒ†ã‚¹ãƒˆç”¨ã‚µãƒ³ãƒ—ãƒ«ã‚¢ã‚»ãƒƒãƒˆã®ä½œæˆ

---

## å®Ÿè£…å®Œäº† (2026-01-04)

ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¿½åŠ ãƒ»æ›´æ–°ã•ã‚Œã¾ã—ãŸï¼š

### æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«
- `packages/stage-ui/src/components/scenes/PNGtuber.vue` - PNGtuberã‚·ãƒ¼ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- `packages/stage-ui/src/stores/pngtuber.ts` - PNGtuberçŠ¶æ…‹ç®¡ç†ã‚¹ãƒˆã‚¢
- `packages/stage-ui/src/utils/pngtuber-zip-loader.ts` - PNGtuber ZIPãƒ­ãƒ¼ãƒ€ãƒ¼
- `packages/stage-ui/src/assets/pngtuber/models/sample/manifest.json` - ã‚µãƒ³ãƒ—ãƒ«ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ

### æ›´æ–°ãƒ•ã‚¡ã‚¤ãƒ«
- `packages/stage-ui/src/stores/display-models.ts` - `DisplayModelFormat.PNGtuber` ã¨ `PNGtuberManifest` ã‚’è¿½åŠ 
- `packages/stage-ui/src/stores/settings.ts` - `stageModelRenderer` ã« `'pngtuber'` ã‚’è¿½åŠ 
- `packages/stage-ui/src/components/scenes/Stage.vue` - PNGtuberã‚·ãƒ¼ãƒ³ã®çµ±åˆ
- `packages/stage-ui/src/components/scenes/index.ts` - PNGtuberã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¿½åŠ 
- `packages/stage-ui/src/components/scenarios/dialogs/model-selector/model-selector.vue` - PNGtuberã‚¤ãƒ³ãƒãƒ¼ãƒˆUI

### ä½¿ç”¨æ–¹æ³•
1. Model Selectorãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ã
2. "Add" â†’ "PNGtuber" ã‚’é¸æŠ
3. PNGtuber ZIPãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆmanifest.json + PNGç”»åƒï¼‰ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
4. ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠã—ã¦ä½¿ç”¨é–‹å§‹
